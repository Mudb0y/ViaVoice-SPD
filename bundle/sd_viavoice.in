#!/bin/bash
#
# ViaVoice Speech Dispatcher Module Wrapper
# Runs the module with bundled libraries and ViaVoice runtime
#

# Find our install directory
BASE="$(dirname "$(readlink -f "$0")")"

# Set up environment for ViaVoice
# ECIINI points to the generated eci.ini
export ECIINI="$BASE/usr/lib/ViaVoiceTTS/eci.ini"

# Set ECIINI for ViaVoice (already exported above)
# LD_LIBRARY_PATH not needed - we use --library-path for complete isolation

# Use bundled dynamic linker with explicit library path for complete isolation
# This ensures we NEVER use system /usr/lib libraries
exec "$BASE/usr/lib/ld-linux.so.2" --library-path "$BASE/usr/lib" "$BASE/usr/bin/sd_viavoice.bin" "$@"

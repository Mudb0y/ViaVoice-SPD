#!/bin/bash
#
# ViaVoice Speech Dispatcher Module Wrapper
#
# This wrapper sets up the environment for ViaVoice TTS and runs the module.
# It uses LD_LIBRARY_PATH to find ViaVoice libs while letting the system
# provide standard libs (libc, pthread, etc.) for compatibility.
#

# Find our install directory (resolve symlinks)
BASE="$(dirname "$(readlink -f "$0")")"

# Set up environment for ViaVoice
# ECIINI tells ViaVoice where to find the voice configuration
export ECIINI="$BASE/usr/lib/ViaVoiceTTS/eci.ini"

# Add our lib directory to library path
# ViaVoice-specific libs (libibmeci50.so, libstdc++-libc6.1-1.so.2) live here
export LD_LIBRARY_PATH="$BASE/usr/lib${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH}"

# Run the module
exec "$BASE/usr/bin/sd_viavoice.bin" "$@"
